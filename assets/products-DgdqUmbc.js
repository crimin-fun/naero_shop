import{m as Be,r,D as Ge,G as Ve,j as e,C as X,E as de,F as We}from"./index-4-g7C5eA.js";import{d as u,a as l,c as o}from"./index.es-v7lyHgBb.js";import{C as ie,a as me}from"./CCardBody-Bw7oagfH.js";import{C as he}from"./CCardHeader-Bmw0R4Jx.js";import{C as He,d as qe,b as ze,e as S}from"./CTable-CbS0M52O.js";import{d as Oe}from"./cil-truck-Cg7ugVDW.js";import{c as Je}from"./cil-check-Dqg5Ixbd.js";import{a as Y,c as Ue}from"./cil-trash-JhHsuKen.js";import{C as Ze}from"./CForm-DR6yyYh2.js";import{C as pe}from"./CRow-OcYn1Zir.js";import{C as d}from"./CFormLabel-Dg53z-7Y.js";import{C as ue}from"./CFormSelect-uED6dN2U.js";import{C as c}from"./CFormInput-tBHjdnx4.js";import{C as N}from"./CInputGroup-BrZgjIIG.js";import{C as xe}from"./CInputGroupText-Dx7bPObr.js";import{C as ee}from"./CFormTextarea-w5wR62sr.js";import{C as se}from"./CFormCheck-cbKcUbO5.js";import{C as Qe,a as Ke,b as Xe,c as Ye,d as es}from"./CModalTitle-BBjVBU7Y.js";import"./CFormControlWrapper-B5Byh9EQ.js";import"./CFormControlValidation-WESAoRrS.js";import"./DefaultLayout-Dg7-BY_M.js";const vs=()=>{const{t:a,i18n:h}=Be(),[P,f]=r.useState(!1),[k,D]=r.useState(!1),[ae,ge]=r.useState(!1),[te,je]=r.useState(!1),[re,I]=r.useState(!1),[A,y]=r.useState(""),[E,x]=r.useState(""),[T,g]=r.useState(""),[L,j]=r.useState(""),[$,M]=r.useState(""),[R,B]=r.useState(""),[G,V]=r.useState(""),[W,H]=r.useState(""),[q,z]=r.useState(""),[O,J]=r.useState(""),[m,p]=r.useState([{lang:"ar",key:"",value:""}]),[C,oe]=r.useState([]),[Ce,ne]=r.useState("NEW"),i=r.useRef(null),[v,be]=r.useState([]),[Ne,fe]=r.useState(""),[ss,ye]=r.useState([]),[U,le]=r.useState([]),[Z,ve]=r.useState(!0),[we,w]=r.useState(!1),[_,ce]=r.useState(!1),b=r.useRef(null);r.useEffect(()=>{_e(),Q(),i.current.setAttribute("process","NEW"),document.title="Admin - Products"},[]);const _e=async()=>{const s=await Ge();be(s),s.length>0&&y(s[0].id)},Q=async()=>{const s=await Ve();ye(s),le(s),ve(!1)},Fe=()=>{i.current.setAttribute("process","NEW"),ne("NEW"),x(""),g(""),j(""),x(""),g(""),j(""),M(""),B(""),H(""),z(""),J(""),V(""),p([{lang:"ar",key:"",value:""}]),v.length>0&&y(v[0].id),f(!0)},Se=()=>{p([...m,{lang:"ar",key:"",value:""}])},Pe=s=>{if(m.length==1){I(!1),p([{key:"",value:""}]);return}const t=m.filter((n,F)=>F!==s);p(t)},ke=s=>{const t=Array.from(s.target.files);oe([...C,...t])},De=s=>{const t=[...C];t.splice(s,1),oe(t)},K=(s,t)=>{const n=m.map((F,Re)=>Re===s?{...F,[t.target.name]:t.target.value}:F);p(n)},Ie=async s=>{switch(s.preventDefault(),i.current.getAttribute("process")){case"NEW":D(!0),await de(A,E,T,L,$,R,G,C,W,q,O,m);break;case"EDIT":const t=JSON.parse(i.current.getAttribute("item"));D(!0),await de(A,E,T,L,$,R,G,C,W,q,O,m,t);break}f(!1),Q(),D(!1),x(""),g(""),j("")},Ae=s=>{b.current.setAttribute("process","DELETE"),b.current.setAttribute("id",s),w(!0)},Ee=s=>{f(!0),x(s.arName),g(s.frName),j(s.enName),M(s.price),B(s.discount),H(s.arDescription),z(s.frDescription),J(s.enDescription),p(s.properties),V(s.quantity),y(s.category),s.properties!=null&&s.properties.length>0&&I(!0),i.current.setAttribute("process","EDIT"),ne("EDIT"),i.current.setAttribute("item",JSON.stringify(s))},Te=async()=>{const s=b.current.getAttribute("process"),t=b.current.getAttribute("id");switch(s){case"DELETE":ce(!0),await We(t),ce(!1),w(!1),Q();break}},Le=s=>{fe(s);let t=v.filter(n=>n[`${h.language}Name`].toLowerCase().includes(s.toLowerCase()));le(t)},$e=e.jsxs(e.Fragment,{children:[e.jsx("span",{ref:i}),!P&&e.jsx(e.Fragment,{children:e.jsxs(ie,{className:"mb-4",children:[e.jsx(he,{children:a("admin_dashboard.products.all_products")}),e.jsxs(me,{className:"px-0 py-1",children:[!Z&&e.jsx(He,{className:"my-0",children:e.jsx(qe,{children:U.map((s,t)=>e.jsxs(ze,{style:t==U.length-1?{borderColor:"transparent"}:{},children:[e.jsx(S,{children:e.jsxs("div",{className:"d-flex bd-highlight",children:[e.jsx("div",{className:"p-2 bd-highlight",children:e.jsx("div",{className:"image-container-50",children:e.jsx("img",{className:"rounded image-cover",src:s.imageLinks[0]})})}),e.jsx("div",{className:"p-2 bd-highlight align-self-center",children:s[`${h.language}Name`]})]})}),e.jsx(S,{className:"py-3 d-none d-sm-table-cell",children:s.discount!=0?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"py-0 my-0 text-secondary",children:e.jsxs("del",{children:[s.price," ",a(`common.${h.language}Currency`)]})}),e.jsxs("p",{className:"py-0 my-0",children:[s.price-s.discount," ",a(`common.${h.language}Currency`)]})]}):e.jsxs("p",{className:"my-0 mt-3",children:[s.price," ",a(`common.${h.language}Currency`)]})}),e.jsxs(S,{className:"py-3 d-none d-sm-table-cell",children:[e.jsxs("p",{className:"py-0 my-0",children:[e.jsx(u,{icon:Oe,className:"tr-ty-2"})," ",a("admin_dashboard.products.orders")+": "+s.orders]}),e.jsxs("p",{className:"py-0 my-0",children:[e.jsx(u,{icon:Je,className:"tr-ty-2"})," ",a("admin_dashboard.products.sold")+": "+s.sold]})]}),e.jsx(S,{width:"40px",children:e.jsxs("div",{className:"d-flex my-2 flex-row-reverse bd-highlight h-50p",children:[e.jsx(l,{color:"danger text-white flex-grow-0 align-self-center bd-highlight",size:"sm",onClick:()=>Ae(s.id),children:e.jsx(u,{icon:Y,style:{width:"15px"},customClassName:"nav-icon"})}),e.jsx(l,{color:"primary me-2 flex-grow-0 align-self-center bd-highlight",size:"sm",onClick:()=>Ee(s),children:e.jsx(u,{icon:Ue,style:{width:"15px"},customClassName:"nav-icon"})})]})})]},t))})}),Z&&e.jsx("div",{className:"text-center",children:e.jsx(X,{color:"white",className:"ms-2"})}),!Z&&U.length=="0"&&e.jsxs("p",{className:"text-center my-3",children:[" ",a("common.no_results")]})]})]})})]}),Me=e.jsx(e.Fragment,{children:P&&e.jsxs(ie,{className:"mb-4",children:[e.jsx(he,{className:"py-0",children:e.jsxs("div",{className:"d-flex bd-highlight",children:[e.jsx("div",{className:"flex-grow-1 bd-highlight px-0",children:e.jsx("h4",{className:"mt-2 pt-1",children:i.current.getAttribute("process")=="NEW"?a("admin_dashboard.products.add_new"):a("admin_dashboard.products.edit")})}),e.jsx("div",{className:"p-2 pe-0 bd-highlight",children:e.jsx(l,{className:"float-end btn-block",onClick:()=>f(!1),type:"button",color:"danger",children:e.jsx("span",{className:"text-white",children:a("common.cancel")})})})]})}),e.jsx(me,{children:e.jsxs(Ze,{onSubmit:Ie,children:[e.jsxs(pe,{children:[e.jsx(d,{htmlFor:"exampleFormControlInput1",children:a("admin_dashboard.products.category")}),e.jsx(o,{xs:12,children:e.jsx(ue,{"aria-label":"Default select example",value:A,onChange:s=>y(s.target.value),children:v.map((s,t)=>e.jsx("option",{value:s.id,children:s[`${h.language}Name`]},t))})}),e.jsx("div",{className:"mt-2"}),e.jsxs(o,{xs:12,sm:4,children:[e.jsxs(d,{className:"mt-2",htmlFor:"exampleFormControlInput1",children:[a("admin_dashboard.products.name")," (",a("common.ar"),")"]}),e.jsx(c,{placeholder:a("admin_dashboard.products.name")+` (${a("common.ar")})...`,value:E,onChange:s=>x(s.target.value)})]}),e.jsxs(o,{xs:12,sm:4,className:"mt-2 mt-sm-0",children:[e.jsxs(d,{className:"mt-2",htmlFor:"exampleFormControlInput1",children:[a("admin_dashboard.products.name")," (",a("common.fr"),")"]}),e.jsx(c,{placeholder:a("admin_dashboard.products.name")+` (${a("common.fr")})...`,value:T,onChange:s=>g(s.target.value)})]}),e.jsxs(o,{xs:12,sm:4,className:"mt-2 mt-sm-0",children:[e.jsxs(d,{className:"mt-2",htmlFor:"exampleFormControlInput1",children:[a("admin_dashboard.products.name")," (",a("common.en"),")"]}),e.jsx(c,{placeholder:a("admin_dashboard.products.name")+` (${a("common.en")})...`,value:L,onChange:s=>j(s.target.value)})]}),e.jsx("div",{className:"mt-2"}),e.jsxs(o,{xs:12,sm:4,children:[e.jsx(d,{className:"mt-2",htmlFor:"exampleFormControlInput1",children:a("admin_dashboard.products.price")}),e.jsxs(N,{children:[e.jsx(c,{pattern:"[0-9]*[.]?[0-9]*",placeholder:a("admin_dashboard.products.price")+"...",value:$,onChange:s=>M(s.target.value)}),e.jsx(xe,{id:"basic-addon1",children:"DZD"})]})]}),e.jsxs(o,{xs:12,sm:4,className:"mt-2 mt-sm-0",children:[e.jsx(d,{className:"mt-2",htmlFor:"exampleFormControlInput1",children:a("admin_dashboard.products.discount")}),e.jsxs(N,{children:[e.jsx(c,{pattern:"[0-9]*[.]?[0-9]*",placeholder:a("admin_dashboard.products.discount")+"...",value:R,onChange:s=>B(s.target.value)}),e.jsx(xe,{id:"basic-addon1",children:"DZD"})]})]}),e.jsxs(o,{xs:12,sm:4,className:"mt-2 mt-sm-0",children:[e.jsx(d,{className:"mt-2",htmlFor:"exampleFormControlInput1",children:a("admin_dashboard.products.quantity")}),e.jsx(N,{children:e.jsx(c,{pattern:"[0-9]*[.]?[0-9]*",placeholder:a("admin_dashboard.products.quantity")+"...",value:G,onChange:s=>V(s.target.value)})})]}),e.jsxs(o,{xs:12,children:[e.jsxs(d,{className:"mt-2",htmlFor:"exampleFormControlInput1",children:[a("admin_dashboard.products.images"),Ce=="EDIT"&&e.jsxs("small",{className:"text-warning",children:[" (",a("admin_dashboard.products.edit_image_note"),")"]})]}),e.jsx(c,{type:"file",accept:"image/*",multiple:!0,onChange:ke}),e.jsx("div",{cs:12,className:"overflow-auto mt-2",style:{whiteSpace:"nowrap"},children:C.map((s,t)=>e.jsxs("div",{className:"image-box mx-1",style:{marginBottom:"10px"},children:[e.jsx("div",{className:"image-container-200",children:e.jsx("img",{className:"rounded image-cover",src:URL.createObjectURL(s),alt:`Image ${t}`})}),e.jsx(l,{onClick:()=>De(t),shape:"rounded-pill",type:"button",color:"danger",children:e.jsx(u,{icon:Y,className:"text-white"})})]},t))})]}),e.jsxs(o,{xs:12,className:"mt-3",children:[e.jsx(d,{htmlFor:"exampleFormControlTextarea1",children:a("admin_dashboard.products.description")+` (${a("common.ar")})`}),e.jsx(ee,{value:W,onChange:s=>H(s.target.value),id:"exampleFormControlTextarea1",rows:3})]}),e.jsxs(o,{xs:12,className:"mt-3",children:[e.jsx(se,{id:"fr_desc",label:a("admin_dashboard.products.description")+` (${a("common.fr")})`,checked:ae,onChange:s=>ge(s.target.checked)}),ae&&e.jsx(ee,{className:"force-ltr",value:q,onChange:s=>z(s.target.value),id:"exampleFormControlTextarea1",rows:3})]}),e.jsxs(o,{xs:12,className:"mt-1",children:[e.jsx(se,{id:"en_desc",label:a("admin_dashboard.products.description")+` (${a("common.en")})`,checked:te,onChange:s=>je(s.target.checked)}),te&&e.jsx(ee,{className:"force-ltr",value:O,onChange:s=>J(s.target.value),id:"exampleFormControlTextarea1",rows:3})]}),e.jsxs(o,{xs:12,className:"mt-1",children:[e.jsx(se,{id:"props",label:a("admin_dashboard.products.properties"),checked:re,onChange:s=>I(s.target.checked)}),re&&e.jsxs(e.Fragment,{children:[m.map((s,t)=>e.jsx("div",{style:{marginBottom:"10px"},children:e.jsxs(N,{children:[e.jsxs(ue,{name:"lang",id:"inputGroupSelect01",value:s.lang,onChange:n=>K(t,n),style:{flex:"0 0 auto",width:"20%"},children:[e.jsx("option",{value:"ar",children:a("common.language.ar")}),e.jsx("option",{value:"fr",children:a("common.language.fr")}),e.jsx("option",{value:"en",children:a("common.language.en")})]}),e.jsx(c,{name:"key",placeholder:a("admin_dashboard.products.property_name"),"aria-label":"Text input with dropdown button",value:s.key,onChange:n=>K(t,n)}),e.jsx(c,{name:"value","aria-label":"Text input with dropdown button",placeholder:a("admin_dashboard.products.property_value"),value:s.value,onChange:n=>K(t,n)}),e.jsx(l,{onClick:()=>Pe(t),type:"button",color:"danger",children:e.jsx(u,{icon:Y,className:"text-white"})})]})},t)),e.jsx(l,{onClick:Se,type:"button",color:"primary",children:a("common.new")})]})]})]}),e.jsxs(l,{disabled:k,className:"mt-3 float-end btn-block w-25",type:"submit",color:"success",children:[!k&&e.jsx("span",{className:"text-white",children:a("common.save")}),k&&e.jsxs("span",{children:[" ",e.jsx(X,{size:"sm",color:"white"})]})]})]})})]})});return e.jsxs(e.Fragment,{children:[e.jsx(pe,{children:e.jsxs(o,{xs:12,className:"px-0 px-sm-2",children:[!P&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"d-flex bd-highlight",children:[e.jsx("div",{className:"p-2 flex-grow-1 bd-highlight px-0",children:e.jsx(N,{className:"mb-3",children:e.jsx(c,{value:Ne,onChange:s=>Le(s.target.value),placeholder:a("admin_dashboard.products.search.placeholder")})})}),e.jsx("div",{className:"p-2 pe-0 bd-highlight",children:e.jsx(l,{className:"float-end btn-block",onClick:()=>Fe(),type:"button",color:"primary",children:a("admin_dashboard.products.add_new")})})]})}),Me,$e]})}),e.jsxs(e.Fragment,{children:[e.jsx("span",{ref:b}),e.jsxs(Qe,{alignment:"center",backdrop:"static",visible:we,onClose:()=>w(!1),unmountOnClose:!0,className:"no-close",children:[e.jsx(Ke,{children:e.jsx(Xe,{id:"VerticallyCenteredExample",children:a("admin_dashboard.products.delete.title")})}),e.jsx(Ye,{children:a("admin_dashboard.products.delete.description")}),e.jsxs(es,{children:[e.jsx(l,{color:"secondary",disabled:_,onClick:()=>w(!1),children:a("common.cancel")}),e.jsxs(l,{color:"danger",disabled:_,className:" text-white",onClick:()=>Te(),children:[!_&&a("common.confirm"),_&&e.jsxs("span",{children:[" ",e.jsx(X,{size:"sm",color:"white"})]})]})]})]})]})]})};export{vs as default};
